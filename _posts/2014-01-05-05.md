---
layout: posts
title: Tutorial 5
desc: Controller, Ajax Loading and $http.interceptor
app: ex5-app
controller: ex5-controller
---
# {{ page.desc }}

### Demo
{% raw %}
<div class="demo">
	<label>Seahawks: </label>
	<div class="indent">{{ seahawks }}</div>
</div>
{% endraw %}

### Code
{% highlight html tabsize=2 %}
Seahawks:
	{{ site.ng.open  }}seahawks{{ site.ng.close }}	
{% endhighlight %}


### JavaScript
{% highlight js tabsize=2 %}
(function(ng) {
	ng.
		module("ex5-app", []).
		factory("ex5-interceptor", ["$q", function($q) {
			return {
				// optional method
				response: function(response) {
					response.data = ng.element.map(response.data, function(val) {
						return ng.isString(val) ? val.toUpperCase() : val;
					});
					// do something on success
					return response || $q.when(response);
				}
			};
		}]).
		config(["$httpProvider", function($httpProvider) {
			$httpProvider.interceptors.push("ex5-interceptor");
		}]).
		controller("ex5-controller", ["$scope", "$http", "$timeout",
			function($scope, $http, $timeout) {
				$scope.seahawks = ["loading"];
				$http.
					get("{prefix}/ajax/seahawks.json".format({prefix: ng.site.prefix})).
					success(function(data) {
						$timeout(function() {
							$scope.seahawks = data || ["error"];
						}, 1000, true);
					});
			}
		]);
})(window.angular);
{% endhighlight %}

### Notes
1. ...
1. ...

